<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>USC QRs</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="description" content="Gi·ªè Tre Vi·ªát ‚Äî Ngh·ªá thu·∫≠t ƒëan l√°t truy·ªÅn th·ªëng Vi·ªát Nam: k·ªπ thu·∫≠t ƒëan m√¢y tre, l·ªãch s·ª≠ l√†ng ngh·ªÅ, v√† m·∫´u gi·ªè th·ªß c√¥ng tinh x·∫£o.">
<meta name="keywords" content="ƒëan l√°t, gi·ªè tre, m√¢y tre ƒëan, th·ªß c√¥ng m·ªπ ngh·ªá, l√†ng ngh·ªÅ Vi·ªát Nam, Vietnamese basket weaving, bamboo craft">
<meta name="author" content="Gi·ªè Tre Vi·ªát">
<link rel="canonical" href="https://gio-tre-viet.example.com/">

<meta property="og:type" content="website">
<meta property="og:site_name" content="Gi·ªè Tre Vi·ªát">
<meta property="og:locale" content="vi_VN">
<meta property="og:title" content="Gi·ªè Tre Vi·ªát ‚Äî ƒêan L√°t Truy·ªÅn Th·ªëng">
<meta property="og:description" content="Kh√°m ph√° k·ªπ thu·∫≠t ƒëan m√¢y tre, c√¢u chuy·ªán l√†ng ngh·ªÅ v√† b·ªô s∆∞u t·∫≠p gi·ªè tre th·ªß c√¥ng.">
<meta property="og:url" content="https://gio-tre-viet.example.com/">
<meta property="og:image" content="images/og-basket.jpg">
<meta property="og:image:alt" content="Gi·ªè tre th·ªß c√¥ng Vi·ªát Nam">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Gi·ªè Tre Vi·ªát ‚Äî ƒêan L√°t Truy·ªÅn Th·ªëng">
<meta name="twitter:description" content="Ngh·ªá thu·∫≠t ƒëan l√°t Vi·ªát Nam v·ªõi m√¢y tre, k·ªπ thu·∫≠t, l·ªãch s·ª≠ v√† m·∫´u gi·ªè th·ªß c√¥ng.">
<meta name="twitter:image" content="images/og-basket.jpg">

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß∫</text></svg>">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body { background: #fff; color: #212529; }
  .brand { letter-spacing:.2px; }
  .thumb { display:block; width:100%; height:160px; object-fit:cover; border-radius:.75rem; background-color: var(--bs-secondary-bg); transition: transform .15s ease, box-shadow .15s ease; }
  .thumb:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(0,0,0,.08); }
  .item { display:block; text-decoration:none; color:inherit; }
  figcaption { font-size:.9rem; color: var(--bs-secondary-color); margin-top:.5rem; text-align:center; }
  #status { color: var(--bs-secondary-color); }
  .decoy { position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

  #typedOverlay { position: sticky; top: 0; z-index: 1029; pointer-events: none; }
  #typedChip { display:none; margin: .5rem auto 0; max-width: min(90%, 48rem); backdrop-filter: blur(6px); border: 1px solid rgba(0,0,0,.08); }
  #typedText { letter-spacing:.3px; }
</style>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Gi·ªè Tre Vi·ªát",
  "url": "https://gio-tre-viet.example.com/",
  "description": "Ngh·ªá thu·∫≠t ƒëan l√°t Vi·ªát Nam v·ªõi m√¢y tre ƒëan, l·ªãch s·ª≠ l√†ng ngh·ªÅ v√† k·ªπ thu·∫≠t th·ªß c√¥ng.",
  "inLanguage": "vi-VN",
  "publisher": { "@type": "Organization", "name": "Gi·ªè Tre Vi·ªát" }
}
</script>
</head>
<body>

<nav class="navbar bg-body border-bottom">
  <div class="container">
    <span class="navbar-brand mb-0 h1 brand">USC QRs</span>
    <form class="ms-auto" role="search" onsubmit="return false;">
      <input id="search" class="form-control" type="search" placeholder="Search by class" aria-label="Search by class">
    </form>
  </div>
</nav>

<div id="typedOverlay" aria-live="polite">
  <div id="typedChip" class="rounded-pill px-3 py-2 bg-body shadow-sm text-secondary">
    <span class="me-2">Searching:</span>
    <span id="typedText" class="fw-semibold text-body"></span>
  </div>
</div>

<section class="decoy" aria-hidden="true">
  <h1>Gi·ªè Tre Vi·ªát ‚Äî Ngh·ªá thu·∫≠t ƒêan L√°t Truy·ªÅn Th·ªëng</h1>
  <h2>K·ªπ thu·∫≠t ƒëan m√¢y tre th·ªß c√¥ng</h2>
  <p>ƒêan l√°t Vi·ªát Nam s·ª≠ d·ª•ng v·∫≠t li·ªáu t·ª± nhi√™n nh∆∞ m√¢y, tre, n·ª©a ƒë·ªÉ t·∫°o n√™n c√°c s·∫£n ph·∫©m gi·ªè, r·ªï v√† ƒë·ªì trang tr√≠ tinh x·∫£o.</p>
  <h2>L·ªãch s·ª≠ l√†ng ngh·ªÅ</h2>
  <p>C√°c l√†ng ngh·ªÅ n·ªïi ti·∫øng nh∆∞ Ph√∫ Vinh, Ninh S·ªü, v√† Bao La g√¨n gi·ªØ k·ªπ thu·∫≠t qua nhi·ªÅu th·∫ø h·ªá.</p>
  <h2>B·ªô s∆∞u t·∫≠p gi·ªè tre th·ªß c√¥ng</h2>
  <p>T√¨m hi·ªÉu c√°c m·∫´u gi·ªè truy·ªÅn th·ªëng v√† c√°ch b·∫£o qu·∫£n, s·ª≠ d·ª•ng trong ƒë·ªùi s·ªëng hi·ªán ƒë·∫°i.</p>
</section>

<main class="container py-4">
  <div id="status" class="text-center my-5" role="status" aria-live="polite">
    <div class="spinner-border" aria-hidden="true"></div>
    <div class="mt-2">Loading‚Ä¶</div>
  </div>

  <div id="gallery" class="row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 g-3 d-none"></div>

  <p id="empty" class="text-center text-secondary d-none">No results.</p>
</main>

<div class="modal fade" id="previewModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down modal-xl">
    <div class="modal-content bg-body">
      <button type="button" class="btn-close ms-auto m-3" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="modal-body pt-0">
        <img id="previewImg" alt="" class="img-fluid w-100 rounded">
        <p id="previewTitle" class="text-center text-secondary mt-3 mb-1 small"></p>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const gallery = document.getElementById("gallery");
  const searchInput = document.getElementById("search");
  const statusEl = document.getElementById("status");
  const emptyEl = document.getElementById("empty");
  const modalEl = document.getElementById("previewModal");
  const modal = new bootstrap.Modal(modalEl);
  const previewImg = document.getElementById("previewImg");
  const previewTitle = document.getElementById("previewTitle");

  const typedChip = document.getElementById("typedChip");
  const typedText = document.getElementById("typedText");

  let allFiles = [];
  let overlayTimer = null;

  function showOverlay(text){
    typedText.textContent = text;
    if (text && text.length){
      typedChip.style.display = "inline-flex";
      resetOverlayTimer();
    } else {
      hideOverlay();
    }
  }

  function resetOverlayTimer(){
    if (overlayTimer) clearTimeout(overlayTimer);
    overlayTimer = setTimeout(() => {
      typedChip.style.display = "none";
    }, 1800);
  }

  function hideOverlay(){
    if (overlayTimer) clearTimeout(overlayTimer);
    typedChip.style.display = "none";
  }

  function render(files){
    gallery.innerHTML = "";
    if (!files.length){
      gallery.classList.add("d-none");
      emptyEl.classList.remove("d-none");
      return;
    }
    emptyEl.classList.add("d-none");
    gallery.classList.remove("d-none");

    files.forEach(entry => {
      const col = document.createElement("div");
      col.className = "col";

      const figure = document.createElement("figure");
      figure.className = "m-0";

      const a = document.createElement("a");
      a.href = "#";
      a.className = "item";
      a.addEventListener("click", (e) => {
        e.preventDefault();
        previewImg.src = `images/${entry.file}`;
        previewImg.alt = entry.title;
        previewTitle.textContent = entry.title;
        modal.show();
      });

      const img = document.createElement("img");
      img.className = "thumb";
      img.src = `images/${entry.file}`;
      img.alt = entry.title;
      img.loading = "lazy";
      img.decoding = "async";

      const cap = document.createElement("figcaption");
      cap.textContent = entry.title;

      a.appendChild(img);
      figure.appendChild(a);
      figure.appendChild(cap);
      col.appendChild(figure);
      gallery.appendChild(col);
    });
  }

  function applySearch(q){
    const query = q.toLowerCase().trim();
    const filtered = allFiles
      .filter(e => e.title.toLowerCase().includes(query))
      .sort((a,b) => a.title.localeCompare(b.title));
    render(filtered);
  }

  fetch("images/index.json")
    .then(r => r.json())
    .then(files => {
      allFiles = files.sort((a,b) => a.title.localeCompare(b.title));
      statusEl.classList.add("d-none");
      render(allFiles);
    })
    .catch(() => {
      statusEl.classList.add("d-none");
      emptyEl.classList.remove("d-none");
      emptyEl.textContent = "Failed to load images.";
    });

  searchInput.addEventListener("input", () => {
    const q = searchInput.value;
    showOverlay(q);
    applySearch(q);
  });

  document.addEventListener("keydown", (e) => {
    const isTypingInInput = e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement || e.target.isContentEditable;
    if (isTypingInInput && e.target !== searchInput) return;

    if (e.key === "/" && !isTypingInInput){
      e.preventDefault();
      searchInput.focus();
      searchInput.select();
      return;
    }

    if (e.key === "Escape"){
      searchInput.value = "";
      showOverlay("");
      applySearch("");
      return;
    }

    if (e.key === "Enter"){
      return;
    }

    if (e.key === "Backspace"){
      e.preventDefault();
      const cur = searchInput.value;
      const next = cur.slice(0, -1);
      searchInput.value = next;
      showOverlay(next);
      applySearch(next);
      return;
    }

    if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey){
      const next = searchInput.value + e.key;
      searchInput.value = next;
      showOverlay(next);
      applySearch(next);
      if (!isTypingInInput) {
        e.preventDefault();
      }
    }
  });
</script>
</body>
</html>
